%%% Version: 19 Jan 2023
%%%
%%% I  =  <MODELNAME>_indexing
%%%
%%% This function defines the indexing for the state variables 
%%% and parameter vector. As a result, specific state variables
%%% can be indexed in a human readable format, e.g., to
%%% access A, use X(I.A). Analogously, the parameter k_d can be 
%%% accessed via par(I.k_d) etc. 
%%%
%%% Input: none
%%%
%%% Output: I - indexing vector
%%%
%%% References:
%%%    - Hornberg, J et al.
%%%     'Control of MAPK signaling: from complexity to what really matters'
%%%     Oncogene, Volume 24, 2005
%%%    - Schoeberl, Birgit; Eichler-Johnson, Claudia; Gilles, Ernst Dieter;
%%%      Mueller, Gertrazd
%%%      'Computational modeling of the dynamics of the MAP
%%%      kinase casade activated by surface and internalized
%%%      EGF receptors'
%%%      Nature Biotechnology Volume 20, 2002
%%%    - Corresponding Model from BioModels Database:
%%%      http://www.ebi.ac.uk/biomodels-main/BIOMD0000000019
%%%
%%% Authors: Jane Knoechel and Wilhelm Huisinga
%%%

function I  =  Hornberg2005EGFRsignalling_indexing

%%% define state index structure
%%%
I.nmstate = {'EGF','EGFR','EGF_EGFR','EGF_EGFR_2','EGF_EGFRa_2','EGFRi',...
    'EGF_EGFRa_2_GAP_Grb2_Prot','EGF_EGFRia_2','Proti','EGF_EGFRi',...
    'EGF_EGFRi_2','Prot','EGFideg','GAP','EGF_EGFRa_2_GAP',...
    'EGFi','EGF_EGFRia_2_GAP','EGF_EGFRia_2_GAP_Grb2','EGF_EGFRia_2_GAP_Grb2_Sos','EGF_EGFRia_2_GAP_Grb2_Sos_Ras_GDP',...
    'EGF_EGFRia_2_GAP_Grb2_Sos_Ras_GTP','Grb2','EGF_EGFRa_2_GAP_Grb2','Sos','EGF_EGFRa_2_GAP_Grb2_Sos',...
    'Ras_GDP','EGF_EGFRa_2_GAP_Grb2_Sos_Ras_GDP','Ras_GTP','EGF_EGFRa_2_GAP_Grb2_Sos_Ras_GTP','Grb2_Sos',...
    'Shc','EGF_EGFRa_2_GAP_Shc','EGF_EGFRa_2_GAP_Shca','EGF_EGFRa_2_GAP_Shca_Grb2','EGF_EGFRa_2_GAP_Shca_Grb2_Sos',...
    'EGF_EGFRa_2_GAP_Shca_Grb2_Sos_Ras_GDP','EGF_EGFRa_2_GAP_Shca_Grb2_Sos_Ras_GTP','Shca_Grb2_Sos','Shca_Grb2','Shca',...
    'Raf','Raf_Ras_GTP','Ras_GTPa','Phosphatase1','Rafa',...
    'Rafa_Pase','MEK','MEK_Rafa','MEK_P','MEK_P_Rafa',...
    'MEK_PP','MEK_PP_Pase2','Phosphatase2','MEK_P_Pase2','ERK',...
    'ERK_MEK_PP','ERK_P','ERK_P_MEK_PP','ERK_PP','Phosphatase3',...
    'ERK_PP_Pase3','ERK_P_Pase3','EGF_EGFRia_2_GAP_Shc','EGF_EGFRia_2_GAP_Shca','EGF_EGFRia_2_GAP_Shca_Grb2',...
    'EGF_EGFRia_2_GAP_Shca_Grb2_Sos','EGF_EGFRia_2_GAP_Shca_Grb2_Sos_Ras_GDP','EGF_EGFRia_2_GAP_Shca_Grb2_Sos_Ras_GTP','Rasi_GTP','Rafi_Rasi_GTP',...
    'Rasi_GTPa','Rafia','Rafia_Pase','MEKi_Rafia','MEKi_P',...
    'MEKi_P_Rafia','MEKi_PP','MEKi_PP_Pase2i','MEKi_P_Pase2i','ERKi_MEKi_PP',...
    'ERKi_P','ERKi_P_MEKi_PP','ERKi_PP','ERKi_PP_Pase3i','ERKi_P_Pase3i',...
    'EGFRideg','EGF_EGFRa_2_GAP_Grb2_Sos_Prot','EGF_EGFRa_2_GAP_Grb2_Sos_Ras_GDP_Prot','EGF_EGFRa_2_GAP_Grb2_Sos_Ras_GTP_Prot',...
    'EGF_EGFRa_2_GAP_Shca_Grb2_Prot','EGF_EGFRa_2_GAP_Shca_Grb2_Sos_Prot','EGF_EGFRa_2_GAP_Shca_Grb2_Sos_Ras_GDP_Prot','EGF_EGFRa_2_GAP_Shca_Grb2_Sos_Ras_GTP_Prot',...
    'EGF_EGFRia_2_deg','EGF_EGFRa_2_GAP_Grb2_Sos_ERK_PP','EGF_EGFRia_2_GAP_Grb2_Sos_ERKi_PP', 'EGF_EGFRa_2_GAP_Shca_Grb2_Sos_ERK_PP',...
    'EGF_EGFRia_2_GAP_Shca_Grb2_Sos_ERKi_PP','Sos_ERK_PP','Sos_ERKi_PP','EGF_EGFRa_2_GAP_Grb2_Sos_deg','EGF_EGFRia_2_GAP_Shca_Grb2_deg','EGF_EGFRa_2_GAP_Shca_Grb2_Sos_deg',...
    'EGF_EGFRia_2_GAP_Grb2_Sos_deg','EGF_EGFRia_2_GAP_Grb2_deg','EGF_EGFRia_2_GAP_Shca_Grb2_Sos_deg','Sosi',...
    'AUC_ERK_PP','EGF_EGFRia_2_GAP_Shca_Grb2_Sos_Ras_deg','EGF_EGFRia_2_GAP_Grb2_Sos_Ras_deg',...
    'EGF_EGFRia_2_GAP_deg','EGF_EGFRia_2_GAP_Shc_deg'};

I.nstates  = length(I.nmstate);  % number (n) of states

%%% TEST: randomly permute the state names !!!
%loadpermut = load('randompermutation.mat'); fprintf('\n   --> random permutation of species names used! \n')
%I.nmstate = I.nmstate(loadpermut.randompermutation);

for i = 1:I.nstates
    I.(I.nmstate{i}) = i;         % name to index mapping
end

%%% define parameter index structure
%%%
I.nmpar = {'k1','kd1',...  % name (nm) of parameters
    'k2','kd2',...
    'k3','kd3',...
    'k4','kd4',...
    'k5','kd5',...
    'k6','kd6',...
    'k7','kd7',...
    'k8','kd8',...
    'k9','kd9',...
    'k10b','kd10',...
    'k11','kd11',...
    'k12','kd12',...
    'k13','kd13',...
    'k14','kd14',...
    'k15','kd15',...
    'k16','kd16',...
    'k17','kd17',...
    'k18','kd18',...
    'k19','kd19',...
    'k20','kd20',...
    'k21','kd21',...
    'k22','kd22',...
    'k23','kd23',...
    'k24','kd24',...
    'k25','kd25',...
    'k26','kd26',...
    'k27','kd27',...
    'k28','kd28',...
    'k29','kd29',...
    'k30','kd30',...
    'k31','kd31',...
    'k32','kd32',...
    'k33','kd33',...
    'k34','kd34',...
    'k35','kd35',...
    'k36','kd36',...
    'k37','kd37',...
    'k38','kd38',...
    'k39','kd39',...
    'k40','kd40',...
    'k41','kd41',...
    'k42','kd42',...
    'k43','kd43',...
    'k44','kd44',...
    'k45','kd45',...
    'k46','kd46',...
    'k47','kd47',...
    'k48','kd48',...
    'k49','kd49',...
    'k50','kd50',...
    'k51','kd51',...
    'k52','kd52',...
    'k53','kd53',...
    'k54','kd54',...
    'k55','kd55',...
    'k56','kd56',...
    'k57','kd57',...
    'k58','kd58',...
    'k59','kd59',...
    'k60','kd60',...
    'k61','kd61',...
    'k62','kd62',...
    'k63','kd63',...
    'k64','kd64',...
    'k65','kd65',...
    'k66','kd66',...
    'k67','kd67',...
    'k68','kd68',...
    'k69','kd69',...
    'k70','kd70',...
    'k71','kd71',...
    'k72','kd72',...
    'k73','kd73',...
    'k74','kd74',...
    'k75','kd75',...
    'k76','kd76',...
    'k77','kd77',...
    'k78','kd78',...
    'k79','kd79',...
    'k80','kd80',...
    'k81','kd81',...
    'k82','kd82',...
    'k83','kd83',...
    'k84','kd84',...
    'k85','kd85',...
    'k86','kd86',...
    'k87','kd87',...
    'k88','kd88',...
    'k89','kd89',...
    'k90','kd90',...
    'k91','kd91',...
    'k92','kd92',...
    'k93','kd93',...
    'k94','kd94',...
    'k95','kd95',...
    'k96','kd96',...
    'k97','kd97',...
    'k98','kd98',...
    'k99','kd99',...
    'k100','kd100',...
    'k101','kd101',...
    'k102','kd102',...
    'k103','kd103',...
    'k104','kd104',...
    'k105','kd105',...
    'k106','kd106',...
    'k107','kd107',...
    'k108','kd108',...
    'k109','kd109',...
    'k110','kd110',...
    'k111','kd111',...
    'k112','kd112',...
    'k113','kd113',...
    'k114','kd114',...
    'k115','kd115',...
    'k116','kd116',...
    'k117','kd117',...
    'k118','kd118',...
    'k119','kd119',...
    'k120','kd120',...
    'k121','kd121',...
    'k122','kd122',...
    'k123','kd123',...
    'k124','kd124',...
    'k125','kd125',...
    'k126','kd126',...
    'k127','kd127',...
    'k128','kd128',...
    'k129','kd129',...
    'k130','kd130',...
    'k131','kd131',...
    'k132','kd132',...
    'k133','kd133',...
    'k134','kd134',...
    'k135','kd135',...
    'k136','kd136',...
    'k137','kd137',...
    'k138','kd138',...
    'k139','kd139',...
    'k140','kd140',...
    'k141','kd141',...
    'k142','kd142',...
    'k143','kd143',...
    'k144','kd144',...
    'k145','kd145',...
    'k146','kd146',...
    'k147','kd147',...
    'k148','kd148'};


I.npar  = length(I.nmpar);        % number (n) of parameters

for i = 1:I.npar
    I.(I.nmpar{i}) = i;        % name to index mapping
end


%%% check for double naming and overlap between state and parameter names
%%%
if I.nstates ~= length(unique(I.nmstate))
    fprintf('--> There are double named state names---PLEASE FIX!\n\n');
    error(':-)');
end
if I.npar ~= length(unique(I.nmpar))
    fprintf('--> There are double named parameter names---PLEASE FIX!\n\n');
    error(':-)');
end
if ~isempty(intersect(I.nmstate,I.nmpar))
    fprintf('--> There is an overlap betwenn state and parameter names---PLEASE FIX!\n\n');
    error(':-)');
end

end

